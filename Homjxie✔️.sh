#!/bin/bash
clear
# COLORS TOOL ^_^ 
RED=$(tput setaf 2 && tput bold) #COLOR RED 
GREEN=$(tput setaf 9 && tput bold) #COLOR GREEN
STAND=$(tput sgr0) #COLOR STAND
BLUE=$(tput setaf 9 && tput bold) #COLOR BLUE


echo -n  News_Metasploit_@Homjxie ✔️ GihadAlkmaty = =;

sleep 3 & while [ "$(ps a | awk '{print $1}' | grep $!)" ] ; do for X in '-' '\' '|' '/'; do echo -en "\b$X"; sleep 0.1; done; done 
clear

# I,dont COLORS in cat << Yes 
cat << !
███╗   ███╗███████╗████████╗ █████╗ ███████╗██████╗ ██╗      ██████╗ ██╗████████╗
████╗ ████║██╔════╝╚══██╔══╝██╔══██╗██╔════╝██╔══██╗██║     ██╔═══██╗██║╚══██╔══╝
██╔████╔██║█████╗     ██║   ███████║███████╗██████╔╝██║     ██║   ██║██║   ██║   
██║╚██╔╝██║██╔══╝     ██║   ██╔══██║╚════██║██╔═══╝ ██║     ██║   ██║██║   ██║   
██║ ╚═╝ ██║███████╗   ██║   ██║  ██║███████║██║     ███████╗╚██████╔╝██║   ██║   
╚═╝     ╚═╝╚══════╝   ╚═╝   ╚═╝  ╚═╝╚══════╝╚═╝     ╚══════╝ ╚═════╝ ╚═╝   ╚═╝   
!
sleep 1.44
clear
#################################################################################
# Twitter www.Twitter.com/GihadAlkmaty
# Github www.Github.com/JihadLkmaty218
# facebook www.facebook.com/GihadAlkmatySy
# Page in facebook www.facebook.com/GihadAlkmaty-hak5
#-------------------------------------------------------
#
#
#
#
#
#
#
#
#
#
#
#
##################################################################################
# tool Gihad Alkmaty

                         # 2017
                # Banner Tools NEws Metasploit the new 
echo $BLUE" ███╗   ███╗███████╗████████╗ █████╗ ███████╗██████╗ ██╗      ██████╗ ██╗████████╗"
echo $BLUE" ████╗ ████║██╔════╝╚══██╔══╝██╔══██╗██╔════╝██╔══██╗██║     ██╔═══██╗██║╚══██╔══╝"
echo $BLUE" ██╔████╔██║█████╗     ██║   ███████║███████╗██████╔╝██║     ██║   ██║██║   ██║"
echo $BLUE" ██║╚██╔╝██║██╔══╝     ██║   ██╔══██║╚════██║██╔═══╝ ██║     ██║   ██║██║   ██║"  
echo $BLUE" ██║ ╚═╝ ██║███████╗   ██║   ██║  ██║███████║██║     ███████╗╚██████╔╝██║   ██║"  
echo $BLUE" ╚═╝     ╚═╝╚══════╝   ╚═╝   ╚═╝  ╚═╝╚══════╝╚═╝     ╚══════╝ ╚═════╝ ╚═╝   ╚═╝"
sleep 2.33 # Time Banner
clear

echo $RED"                          * ===== News_Metasploit_======= *                                    "
echo $RED"| 1:> CVE-2017-0199 Microsoft Office + WordPad    ::   < On Metasploit >                      |"                                       
echo $RED"| 2:> CVE-2017-0016 Memory Corruption Vulnerability                                           |"
echo $RED"| 3:> CVE-2017-0213 privilege Administator On windows 10 bit 32 bit 64 < On CMD >             |"                                                                                        
echo $RED"| 4:> DC/OS Marathon UI Docker Exploit            ::   < On Metasploit >                      |"
echo $RED"| 5:> Samba CVE-2017-7494 Remote Code Execution Vulnerability   ::   < On Metasploit >        |"
echo $RED"| 6:> Microsoft Windows SMB Server CVE-2017-0143 Remote Code Execution Vulnerability          |"
echo $RED"| 7:> BOA Web Server 0.94.14rc21 - Arbitrary File Access CVE-2017-9833                        |"
echo $RED"| 8:> Microsoft Skype 'MSFTEDIT.DLL' Buffer Overflow Vulnerability  CVE-2017-9948             |"
echo $RED"| 9:>                                                                                         |"
echo $RED"| 10:>                                                                                        |"
echo $RED"| 11:>                                                                                        |"
echo $RED"| 12:>                                                                                        |"
echo $RED"| 13:>                                                                                        |"
echo $RED"| 14:>                                                                                        |"
echo $RED"| 15:>                                                                                        |"
echo $RED"| 17:>                                                                                        |"
echo $RED"| 18:>                                                                                        |"
echo $RED"| 19:>                                                                                        |"
echo $RED"| 20:>                                                                                        |"
echo $RED"| 21:>                                                                                        |"
echo $RED"| 22:>                                                                                        |"
echo $RED"| 23:>                                                                                        |"
echo $RED"| 24:>                                                                                        |"
echo $RED"| 25:>                                                                                        |"
echo $RED"| 26:>                                                                                        |"
echo $RED"| 27:>                                                                                        |"
echo $RED"| 28:>                                                                                        |"
echo $RED"| 29:>                                                                                        |"
echo $RED"| 30:>                                                                                        |"
echo $RED"| 31:>                                                                                        |"
echo $RED"| 32:>                                                                                        |"
echo $RED"| 33:>                                                                                        |"
echo $RED"| 34:>                                                                                        |"
echo $RED"| 35:>                                                                                        |"
echo $RED"| 36:>                                                                                        |"
echo $RED"| 37:>                                                                                        |"
echo $RED"| 38:>                                                                                        |"
echo $RED"| 39:>                                                                                        |"
echo $RED"| 40:>                                                                                        |"
echo $RED"| 41:>                                                                                        |"
echo $RED"| 42:>                                                                                        |"
echo $RED"| 43:>                                                                                        |"
echo $RED"| 44:>                                                                                        |"
echo $RED"| 45:>                                                                                        |"
echo $RED"| 46:>                                                                                        |"
echo $RED"|  ==========================================News1======================================       |"
echo $RED"| 47:>                                                                                        |"
echo $RED"| 48:>                                                                                        |"
echo $RED"| 49:>                                                                                        |"
echo $RED"| 50:>                                                                                        |"
echo $RED"| 51:>                                                                                        |"
echo $RED"| 52:>                                                                                        |"
echo $RED"| 53:>                                                                                        |"
echo $RED"| 54:>                                                                                        |"
echo $RED"| 55:>                                                                                        |"
echo $RED"| 56:>                                                                                        |"
echo $RED"| 57:>                                                                                        |"
echo $RED"| 58:>                                                                                        |"
echo $RED"| 59:>                                                                                        |"
echo $RED"| 60:>                                                                                        |"
echo $RED"| 61:>                                                                                        |"
echo $RED"| 42:>                                                                                        |"
echo $RED"| 43:>                                                                                        |"
echo $RED"| 64:>                                                                                        |"
echo $RED"|_____________________________________________________________________________________________|"
echo $RED"       _______________________________________________________________________"
echo $BLUE"                               @GihadAlkmaty $STAND"
read menuoption

if [ $menuoption = "1" ]; then
echo "ok"
sleep 0.33
cat << !
A remote code execution vulnerability exists in the way that Microsoft Office and WordPad parse specially crafted files. An attacker who successfully exploited this vulnerability could take control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Exploitation of this vulnerability requires that a user open or preview a specially crafted file with an affected version of Microsoft Office or WordPad. In an email attack scenario, an attacker could exploit the vulnerability by sending a specially crafted file to the user and then convincing the user to open the file.The update addresses the vulnerability by correcting the way that Microsoft Office and WordPad parses specially crafted files, and by enabling API functionality in Windows that Microsoft Office and WordPad will leverage to resolve the identified issue
---------------------------------------------
2
---------------------------------------------------
Exploit toolkit CVE-2017-0199 - v3.0 is a handy python script which provides pentesters and security researchers a quick and effective way to exploit Microsoft RTF RCE. It could generate a malicious (Obfuscated) RTF file and deliver metasploit / meterpreter / other payload to victim without any complex configuration.
----------------------------------------------------------------
what is the CVE-2017-0199
--------------------------------
FireEye recently detected malicious Microsoft Office RTF documents that leverage CVE-2017-0199, a previously undisclosed vulnerability. This vulnerability allows a malicious actor to download and execute a Visual Basic script containing PowerShell commands when a user opens a document containing an embedded exploit. FireEye has observed Office documents exploiting CVE-2017-0199 that download and execute malware payloads from different well-known malware families.
FireEye shared the details of the vulnerability with Microsoft and has been coordinating public disclosure timed with the release of a patch by Microsoft to address the vulnerability, which can be found here.
The vulnerability bypassed most mitigations prior to patch availability; however, FireEye email and network products detected the malicious documents
---------------------------------------------
4 what is The Target
--------------------------------------
Microsoft Windows  10
Microsoft Windows Vista x64 Edition Service Pack 2 0
Microsoft Windows Vista SP2
Microsoft Windows Server 2012 0
Microsoft Windows Server 2008 R2 for x64-based Systems SP1
Microsoft Windows Server 2008 R2 for Itanium-based Systems SP1
Microsoft Windows Server 2008 for x64-based Systems SP2
Microsoft Windows Server 2008 for Itanium-based Systems SP2
Microsoft Windows Server 2008 for 32-bit Systems SP2
Microsoft Windows 7 for x64-based Systems SP1
Microsoft Windows 7 for 32-bit Systems SP1
Microsoft Office 2016 (64-bit edition) 0
Microsoft Office 2016 (32-bit edition) 0
Microsoft Office 2013 Service Pack 1 (64-bit editions)
Microsoft Office 2013 Service Pack 1 (32-bit editions)
Microsoft Office 2010 Service Pack 2 (64-bit editions) 0
Microsoft Office 2010 Service Pack 2 (32-bit editions) 0
Microsoft Office 2007 Service Pack 3 0
---------------------------------------------------------------------
ok what is the HTA !!!
---------------------------
The power to build HTML Applications (HTAs) brings Windows Internet Explorer to the fore as a viable Windows development platform. HTAs are full-fledged applications. These applications are trusted and display only the menus, icons, toolbars, and title information that the web developer creates. In short, HTAs pack all the power of Internet Explorer—its object model, performance, rendering power and protocol support—without enforcing the strict security model and user interface of the browser.
----------------------------------------------
2 what is the HTA
----------------------------------
Historically, programming languages like C++ and Microsoft Visual Basic have provided the object models and access to system resources that developers demand. With HTAs, Dynamic HTML (DHTML) with script can be added to that list. HTAs not only support everything a webpage does—namely HTML, Cascading Style Sheets (CSS), scripting languages, and behaviors—but also HTA–specific functionality. This added functionality provides control over user interface design and access to the client system. Moreover, run as trusted applications, HTAs are not subject to the same security constraints as webpages. As with any executable file, the user is asked once, before the HTA is downloaded, whether to save or run the application; if saved to the client machine, it simply runs on demand thereafter. The end result is that an HTA runs like any executable (.exe) file written in C++ or Visual Basic.
HTAs are suited to many uses, whether you are prototyping, making wizards, or building full-scale applications. Everything DHTML and script can deliver—forms, multimedia, web applications, HTML editors, and browsers—HTAs can too... and then some. In fact, HTAs can make some tasks easier. The simplicity of generating prototypes using HTAs makes it possible for designers to script dialog boxes and alerts while the C++ or Visual Basic developers program the underlying functionality.
----------------------------------------------
Exploit::> https://github.com/bhdresh/CVE-2017-0199
----------------------------------------------------
or Tool my GihadAlkmaty On Github 
https://github.com/jihadLkmaty218/tool-New-my-CVE-2017
------------------------------------
!
sleep 2.55
read -p "Enter ^_^ "
bash GihadAlkmaty0199.sh
else

if [ $menuoption = "2" ]; then
cat << !
-----------
1
---------------------------------------------------
Microsoft Windows 10 Gold, 1511, and 1607; Windows 8.1; Windows RT 8.1; Windows Server 2012 R2, and Windows Server 2016 do not properly handle certain requests in SMBv2 and SMBv3 packets, which allows remote attackers to execute arbitrary code via a crafted SMBv2 or SMBv3 packet to the Server service, aka "SMBv2/SMBv3 Null Dereference Denial of Service Vulnerability.
-------------------------------------------------------
2
---------------------------------------------------
A denial of service vulnerability exists in implementations of the Microsoft Server Message Block 2.0 and 3.0 (SMBv2/SMBv3) client. The vulnerability is due to improper handling of certain requests sent by a malicious SMB server to the client. An attacker who successfully exploited this vulnerability could cause the affected system to stop responding until it is manually restarted.To exploit the vulnerability, an attacker could use various methods such as redirectors, injected HTML header links, etc., which could cause the SMB client to connect to a malicious SMB server.The security update addresses the vulnerability by correcting how the Microsoft SMBv2/SMBv3 Client handles specially crafted requests
---------------------------
3
---------------------------------
Exploit In Github
https://github.com/lgandx/PoC/tree/master/SMBv3%20Tree%20Connect
----------------------------
or tool my in Github my Yes 
https://github.com/jihadLkmaty218/tool-New-my-CVE-2017
!
sleep 1.33
read -p "Enter"
bash GihadAlkmaty0199.sh
else

if [ $menuoption = "3" ]; then
cat << !
1
----------------------------------------
CVE-2017-0213 privilege Administator On windows 10 
------------------------
2
------------------------------------
An elevation of privilege exists in Windows COM Aggregate Marshaler. An attacker who successfully exploited the vulnerability could run arbitrary code with elevated privileges.To exploit the vulnerability, an attacker could run a specially crafted application that could exploit the vulnerability. This vulnerability by itself does not allow arbitrary code to be run.  However, this vulnerability could be used in conjunction with one or more vulnerabilities (e.g. a remote code execution vulnerability and another elevation of privilege) that could take advantage of the elevated privileges when running.The update addresses the vulnerability by correcting how Windows COM Marshaler processes interface requests.
---------------------
3
---------------------------------------
Exploit in Github my
https://github.com/jihadLkmaty218/CVE-2017-0213-
----------------------------
Vulnerable
--------------------------------
| Windows 10 			√     
| Windows 10 	1511 	      
| Windows 10 	1607         
| Windows 10 	1703 		√   
| Windows 7 		SP1 	√    
| Windows 8.1 			        
| Windows RT 8.1 			    
| Windows Server 2008 		SP2 	
| Windows Server 2008 	R2 	SP1  	
| Windows Server 2012 			 
| Windows Server 2012 	R2 		 
| Windows Server 2016 			 
---------------------------------
!
sleep 1.33
read -p "Enter"
bash GihadAlkmaty0199.sh
else

if [ $menuoption = "4" ]; then
cat << !
1
----------------
Utilizing the DCOS Cluster's Marathon UI, an attacker can create a docker container with the '/' path mounted with read/write permissions on the host server that is running the docker container. As the docker container executes command as uid 0 it is honored by the host operating system allowing the attacker to edit/create files owed by root. This exploit abuses this to creates a cron job in the '/etc/cron.d/' path of the host server. *Notes: The docker image must be a valid docker image from hub.docker.com. Further more the docker container will only deploy if there are resources available in the DC/OS cluster.
-------------------------------------------------------------
2
--------------------------------
docker container with the '/' path mounted with read/write permissions on the host server that is running the docker container. As the docker container executes command as uid 0 it is honored by the host operating system allowing the attacker to edit/create files owed by root. This exploit abuses this to creates a cron job in the '/etc/cron.d/' path of the host server. *Notes: The docker image must be a valid docker image from hub.docker.com. Further more the docker container will only deploy if there are resources available in the DC/OS cluster

-------------------------
3 ok what is the 
DC/OS (the datacenter operating system) is an open-source, distributed operating system based on the Apache Mesos distributed systems kernel. DC/OS manages multiple machines in the cloud or on-premises from a single interface; deploys containers, distributed services, and legacy applications into those machines; and provides networking, service discovery and resource management to keep the services running and communicating with each other.

------------------------
4
----------------------
update Metasploit 
Terminal:#> msfupdate
ok next
exploit/linux/http/dcos_marathon
-------------------------------------
or Download Script Exploit From Github my
https://github.com/jihadLkmaty218/Exploit-DC-OS-Marathon-UI---Docker-
---------------------------------------------
!
read -p "Enter"
bash GihadAlkmaty0199.sh
else

if [ $menuoption = "5" ]; then
cat << !
what is the Exploit Samba !
-----------------------
1
This module triggers an arbitrary shared library load vulnerability in Samba versions 3.5.0 to 4.4.14, 4.5.10, and 4.6.4. This module requires valid credentials, a writeable folder in an accessible share, and knowledge of the server-side path of the writeable folder. In some cases, anonymous access combined with common filesystem locations can be used to automatically exploit this vulnerability
--------------------------------------------------------------
2
------------------------------
All versions of Samba from 3.5.0 onwards are vulnerable to a remote
code execution vulnerability, allowing a malicious client to upload a
shared library to a writable share, and then cause the server to load
and execute it
-----------------------------
update Metasploit
Terminal:#> msfupdate
exploit/linux/samba/is_known_pipename
or Download Script Exploit From Github my 
https://github.com/jihadLkmaty218/CVE-2017-7494
--------------------------------------------------
Vulnerable:
Ubuntu Ubuntu Linux 17.04
SuSE Linux Enterprise Software Development Kit 12 SP2
SuSE Linux Enterprise Software Development Kit 12 SP1
SuSE Linux Enterprise Software Development Kit 11 SP4
SuSE Linux Enterprise Server for Raspberry Pi 12-SP2
SuSE Linux Enterprise Server 12-SP2
SuSE Linux Enterprise Server 12-SP1
SuSE Linux Enterprise Server 11 SP4
SuSE Linux Enterprise Server 11 SP3 LTSS
SuSE Linux Enterprise Point of Sale 11-SP3
SuSE Linux Enterprise High Availability 12-SP2
SuSE Linux Enterprise High Availability 12-SP1
SuSE Linux Enterprise Desktop 12-SP2
SuSE Linux Enterprise Desktop 12-SP1
SuSE Linux Enterprise Debuginfo 11 SP4
SuSE Linux Enterprise Debuginfo 11 SP3
Samba Samba 4.6.1
Samba Samba 4.6
Samba Samba 4.5.7
Samba Samba 4.5.6
Samba Samba 4.5.5
Samba Samba 4.5.4
Samba Samba 4.5.1
Samba Samba 4.5
Samba Samba 4.4.12
Samba Samba 4.4.11
Samba Samba 4.4.10
Samba Samba 4.4.9
Samba Samba 4.4.7
Samba Samba 4.4.6
Samba Samba 4.4.1
Samba Samba 4.4
Samba Samba 4.3.7
Samba Samba 4.3.5
Samba Samba 4.3.4
Samba Samba 4.3.3
Samba Samba 4.3.2
Samba Samba 4.3.1
Samba Samba 4.3
Samba Samba 4.2.10
Samba Samba 4.2.8
Samba Samba 4.2.7
Samba Samba 4.2.6
Samba Samba 4.2.5
Samba Samba 4.2.4
Samba Samba 4.2.3
Samba Samba 4.2.2
Samba Samba 4.2.1
Samba Samba 4.2
Samba Samba 4.1.22
Samba Samba 4.1.21
Samba Samba 4.1.20
Samba Samba 4.1.19
Samba Samba 4.1.18
Samba Samba 4.1.17
Samba Samba 4.1.16
Samba Samba 4.1.15
Samba Samba 4.1.14
Samba Samba 4.1.13
Samba Samba 4.1.10
Samba Samba 4.1.9
Samba Samba 4.1.7
Samba Samba 4.1.3
Samba Samba 4.1.2
Samba Samba 4.1.1
Samba Samba 4.1
Samba Samba 4.0.24
Samba Samba 4.0.23
Samba Samba 4.0.21
Samba Samba 4.0.20
Samba Samba 4.0.19
Samba Samba 4.0.18
Samba Samba 4.0.17
Samba Samba 4.0.13
Samba Samba 4.0.12
Samba Samba 4.0.10
Samba Samba 4.0.2
Samba Samba 3.5.22
Samba Samba 3.5.21
Samba Samba 3.5.16
Samba Samba 3.5.13
Samba Samba 3.5.9
Samba Samba 3.5.8
Samba Samba 3.5.2
Samba Samba 3.5.1
Samba Samba 3.5
Samba Samba 4.5.3
Samba Samba 4.5.2
Samba Samba 4.4.8
Samba Samba 4.4.5
Samba Samba 4.4.4
Samba Samba 4.4.3
Samba Samba 4.4.2
Samba Samba 4.3.9
Samba Samba 4.3.8
Samba Samba 4.3.6
Samba Samba 4.3.13
Samba Samba 4.3.11
Samba Samba 4.3.10
Samba Samba 4.2.9
+ Trustix Secure Linux 2.0
+ Trustix Secure Linux 1.5
Samba Samba 4.2.14
Samba Samba 4.2.13
Samba Samba 4.2.12
Samba Samba 4.2.11
Samba Samba 4.1.8
Samba Samba 4.1.6
Samba Samba 4.1.5
Samba Samba 4.1.23
+ Trustix Secure Linux 2.0
+ Trustix Secure Linux 1.5
Samba Samba 4.1.11
Samba Samba 4.0.9
Samba Samba 4.0.8
Samba Samba 4.0.7
Samba Samba 4.0.6
Samba Samba 4.0.5
Samba Samba 4.0.4
Samba Samba 4.0.3
Samba Samba 4.0.22
Samba Samba 4.0.16
Samba Samba 4.0.15
Samba Samba 4.0.14
Samba Samba 4.0.11
Samba Samba 4.0.1
Samba Samba 4.0.0
Samba Samba 3.5.7
Samba Samba 3.5.6
Samba Samba 3.5.5
Samba Samba 3.5.4
Samba Samba 3.5.3
Samba Samba 3.5.20
Samba Samba 3.5.19
Samba Samba 3.5.18
Samba Samba 3.5.15
Samba Samba 3.5.14
Samba Samba 3.5.10
Redhat Gluster 3.2 on RHEL-7
Redhat Gluster 3.2 on RHEL-6
Redhat Enterprise Linux Workstation Optional 7
Redhat Enterprise Linux Workstation 7
Redhat Enterprise Linux Workstation 6
Redhat Enterprise Linux Server Optional 7
Redhat Enterprise Linux Server 7
Redhat Enterprise Linux Server 5
Redhat Enterprise Linux Resilient Storage 7
Redhat Enterprise Linux HPC Node 6
Redhat Enterprise Linux Desktop Optional 6
Redhat Enterprise Linux Desktop 6
Redhat Enterprise Linux ComputeNode Optional 7
Redhat Enterprise Linux ComputeNode 7
Oracle Enterprise Linux 6.2
Oracle Enterprise Linux 6
Oracle Enterprise Linux 5
openSUSE Leap 42.1
HP NonStop T1201L01^AAL
HP NonStop T1201L01
HP NonStop T1201H01^AAM
HP NonStop T1201H01
HP Common Internet File System Server B.04.05.03.00
HP Common Internet File System Server A.03.02.00
Debian Linux 6.0 sparc
Debian Linux 6.0 s/390
Debian Linux 6.0 powerpc
Debian Linux 6.0 mips
Debian Linux 6.0 ia-64
Debian Linux 6.0 ia-32
Debian Linux 6.0 ia-30
Debian Linux 6.0 arm
Debian Linux 6.0 amd64
Cisco Video Surveillance Manager 7.9
Cisco Video Surveillance Manager 7.8
Cisco Video Surveillance Manager 7.7
Cisco Prime Network Analysis Module Software 6.2(1b)
Cisco MXE 3000 Series Media Experience Engines 3.5.2
Cisco MXE 3000 Series Media Experience Engines 3.5.1
Cisco MXE 3000 Series Media Experience Engines 3.5
CentOS CentOS 6
----------------------------------------------------
Not Vulnerable:
Samba Samba 4.6.4
Samba Samba 4.5.10
Samba Samba 4.4.14 
-------------------------------------------------
!
read -p "Enter"
bash GihadAlkmaty0199.sh
else

if [ $menuoption = "6" ]; then
echo "ok !"
cat << !
-----------------------------
1
------------------------------------
The SMBv1 server in Microsoft Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; and Windows 10 Gold, 1511, and 1607; and Windows Server 2016 allows remote attackers to execute arbitrary code via crafted packets, aka "Windows SMB Remote Code Execution Vulnerability." This vulnerability is different from those described in CVE-2017-0144, CVE-2017-0145, CVE-2017-0146, and CVE-2017-0148. 
-----------------------------------
2

A remote code execution vulnerability exist in Microsoft Server Message Block 1.0 (SMBv1). The vulnerability is due to the way SMBv1 service handles certain requests. An attacker who successfully exploited the vulnerability could gain code execution on the target server.
-----------------------------------
3
Exploit
------------------------
update Metasploit
Terminal:#> msfupdate
msf > use exploit/windows/smb/ms17_010_eternalblue 
---------------------------------------------------------
msf exploit(ms17_010_eternalblue) > info 
                                             
                          ########                  #
                      #################            #
                   ######################         #
                  #########################      #
                ############################
               ##############################
               ###############################
              ###############################
              ##############################
                              #    ########   #
                 ##        ###        ####   ##
                                      ###   ###
                                    ####   ###
               ####          ##########   ####
               #######################   ####
                 ####################   ####
                  ##################  ####
                    ############      ##
                       ########        ###
                      #########        #####
                    ############      ######
                   ########      #########
                     #####       ########
                       ###       #########
                      ######    ############
                     #######################
                     #   #   ###  #   #   ##
                     ########################
                      ##     ##   ##     ##
                            http://metasploit.com


       =[ metasploit v4.14.27-dev                         ]
+ -- --=[ 1659 exploits - 951 auxiliary - 293 post        ]
+ -- --=[ 486 payloads - 40 encoders - 9 nops             ]
+ -- --=[ Free Metasploit Pro trial: http://r-7.co/trymsp ]

msf > use exploit/windows/smb/ms17_010_eternalblue 
msf exploit(ms17_010_eternalblue) > info

       Name: MS17-010 EternalBlue SMB Remote Windows Kernel Pool Corruption
     Module: exploit/windows/smb/ms17_010_eternalblue
   Platform: Windows
 Privileged: Yes
    License: Metasploit Framework License (BSD)
       Rank: Average
  Disclosed: 2017-03-14

Provided by:
  Sean Dillon <sean.dillon@risksense.com>
  Dylan Davis <dylan.davis@risksense.com>
  Equation Group
  Shadow Brokers
  thelightcosine

Available targets:
  Id  Name
  --  ----
  0   Windows 7 and Server 2008 R2 (x64) All Service Packs

Basic options:
  Name                Current Setting  Required  Description
  ----                ---------------  --------  -----------
  GroomAllocations    12               yes       Initial number of times to groom the kernel pool.
  GroomDelta          5                yes       The amount to increase the groom count by per try.
  MaxExploitAttempts  3                yes       The number of times to retry the exploit.
  ProcessName         spoolsv.exe      yes       Process to inject payload into.
  RHOST                                yes       The target address
  RPORT               445              yes       The target port (TCP)
  SMBDomain           .                no        (Optional) The Windows domain to use for authentication
  SMBPass                              no        (Optional) The password for the specified username
  SMBUser                              no        (Optional) The username to authenticate as
  VerifyArch          true             yes       Check if remote architecture matches exploit Target.
  VerifyTarget        true             yes       Check if remote OS matches exploit Target.

Payload information:
  Space: 2000

Description:
  This module is a port of the Equation Group ETERNALBLUE exploit, 
  part of the FuzzBunch toolkit released by Shadow Brokers. There is a 
  buffer overflow memmove operation in Srv!SrvOs2FeaToNt. The size is 
  calculated in Srv!SrvOs2FeaListSizeToNt, with mathematical error 
  where a DWORD is subtracted into a WORD. The kernel pool is groomed 
  so that overflow is well laid-out to overwrite an SMBv1 buffer. 
  Actual RIP hijack is later completed in 
  srvnet!SrvNetWskReceiveComplete. This exploit, like the original may 
  not trigger 100% of the time, and should be run continuously until 
  triggered. It seems like the pool will get hot streaks and need a 
  cool down period before the shells rain in again. The module will 
  attempt to use Anonymous login, by default, to authenticate to 
  perform the exploit. If the user supplies credentials in the 
  SMBUser,SMBPass, and SMBDomain options it will use those instead. On 
  some systems, this module may cause system instability and crashes, 
  such as a BSOD or a reboot. This may be more likely with some 
  payloads.

References:
  https://technet.microsoft.com/en-us/library/security/MS17-010
  https://cvedetails.com/cve/CVE-2017-0143/
  https://cvedetails.com/cve/CVE-2017-0144/
  https://cvedetails.com/cve/CVE-2017-0145/
  https://cvedetails.com/cve/CVE-2017-0146/
  https://cvedetails.com/cve/CVE-2017-0147/
  https://cvedetails.com/cve/CVE-2017-0148/
  https://github.com/RiskSense-Ops/MS17-010

msf exploit(ms17_010_eternalblue) > 
-----------------------------------------------------------------
Vulnerable:
Unify OpenStage Xpert 6010p 5R1
Unify OpenStage Xpert 6010p 5
Microsoft Windows XP Embedded SP3 x86
Microsoft Windows XP Sp3 X86
Microsoft Windows XP Sp2 X64
Microsoft Windows Vista x64 Edition Service Pack 2 0
Microsoft Windows Vista Service Pack 2 0
Microsoft Windows Server 2012 R2 0
Microsoft Windows Server 2012 0
Microsoft Windows Server 2008 R2 for x64-based Systems SP1
Microsoft Windows Server 2008 R2 for Itanium-based Systems SP1
Microsoft Windows Server 2008 for x64-based Systems SP2
Microsoft Windows Server 2008 for Itanium-based Systems SP2
Microsoft Windows Server 2008 for 32-bit Systems SP2
Microsoft Windows Server 2003 x86 SP2
Microsoft Windows Server 2003 x64 SP2
Microsoft Windows RT 8.1
Microsoft Windows 8.1 for x64-based Systems 0
Microsoft Windows 8.1 for 32-bit Systems 0
Microsoft Windows 8 X86
Microsoft Windows 8 X64
Microsoft Windows 7 for x64-based Systems SP1
Microsoft Windows 7 for 32-bit Systems SP1
Microsoft Windows 10 Version 1607 for x64-based Systems 0
Microsoft Windows 10 Version 1607 for 32-bit Systems 0
Microsoft Windows 10 version 1511 for x64-based Systems 0
Microsoft Windows 10 version 1511 for 32-bit Systems 0
Microsoft Windows 10 for x64-based Systems 0
Microsoft Windows 10 for 32-bit Systems 0
Not Vulnerable: 
Unify OpenStage Xpert 6010p 5 R1.5.5
----------------------------------------------
!
sleep 1.33
read -p "Enter"
bash GihadAlkmaty0199.sh
else

if [ $menuoption = "7" ]; then
echo "ok !"
cat << !
-We can read any file located on the server
The server allows the injection of   using the FILECAMERA variable sent by GET to read files with root privileges. Without using access credentials
!
--------------------------
2
-------------------------------------------------
 cgi-bin wapopen in BOA Webserver 0.94.14rc21 allows the injection of     using the FILECAMERA variable  sent by GET  to read files with root privileges
-----------------------------------------------
Exploit
--------------------------
Vulnerable variable:
FILECAMERA=../../etc/shadow%00
 ------------------------------------------
Exploit link:
/cgi-bin/wapopen?B1=OK&NO=CAM_16&REFRESH_TIME=Auto_00&FILECAMERA=../../etc/shadow%00&REFRESH_HTML=auto.htm&ONLOAD_HTML=onload.htm&STREAMING_HTML=streaming.htm&NAME=admin&PWD=admin&PIC_SIZE=0
-------------------------------------------------------------------
Poc:
http://127.0.0.1/cgi-bin/wapopen?B1=OK&NO=CAM_16&REFRESH_TIME=Auto_00&FILECAMERA=../../etc/shadow%00&REFRESH_HTML=auto.htm&ONLOAD_HTML=onload.htm&STREAMING_HTML=streaming.htm&NAME=admin&PWD=admin&PIC_SIZE=0
---------------------------------------------
or Exploit-db
https://www.exploit-db.com/exploits/42290/

!
sleep 1.33
read -p "Enter"
bash GihadAlkmaty0199.sh
else

if [ $menuoption = "8" ]; then
echo "ok"
echo "ok"
cat << !
----------------------------------
1
A remote and local stack buffer overflow vulnerability has been discovered in the official Microsoft Skype v7.2, v7.3.5 & v7.3.6 software client.
The security vulnerability allows to crash the software application with an unexpected exception error, to overwrite the active process registers 
to execute own malcious codes.
-------------------------------------------------------------
The skype software is using a dll in case of a copy request on the local systen. We place a picture in our clipboard (we take a screenshot in 
this example), this needs to be copied from a remote desktop system. This can be pasted into the local skype message box, by the paste function. 
Then the picture is taken from the clipboard (which is the rdp remote clipboard content) and successfully copies it into the message box.
-------------------------------------------------------------
The security vulnerability is located in the `clipboard format` function of the skype software. Attackers are able to use a remote computer 
system with a shared clipboard, to provoke a stack buffer overflow on transmittion to skype. The issue affects the `MSFTEDIT.DLL` dynamic 
link library of the windows8 (x86) operating system. The limitation of the transmitted size and count for images via print of the remote 
session clipboard has no secure limitations or restrictions. Attackers are able to crash the software with one request to overwrite the 
eip register of the active software process. Thus allows local or remote attackers to execute own codes on the affected and connected 
computer systems via the skype software.
-------------------------------------------------------------
The attacker opens a local computer system connection and establishes a RDP connection to another system. First the attacker enables the 
clipboard function for the remote session. This is possible by the basic rdp settings in the `Local Devices & Resources settings. Then the 
attacker moves with a click into the rdp session window and pushes the print key. A screenshot is made of the remote session, that is loaded 
to the local system cache of the first computer system that the attacker uses. Then the attacker moves back to the local system into the 
conversation of skype and copypastes the screenshot of the clipboard (print) to the message body. A clipboard error occurs because of the 
unknown format size and the software crashs with several uncaught access violations or unfiltered exceptions for both parties. The software 
is not terminated and allows to read every dll error by line with offset. 
-------------------------------------------------------------
The error and critical crashs are captured by the software internal dev log called gilasterr.log file. The gilasterr.log file captures 
internal information of the software in case of critical errors for the skype developer teams. During the exploitation process the gilasterr.log 
file captured the loop crashs and overwrite of the eip register as reference. The active offsets allowed us to define a new address to compromise 
the targeted local or remote computer system.
-------------------------------------------------------------
In a software update of the v7.2, v7.3.5 & v7.3.6 version of skype, a limitation has been implemented for the clipboard function. Due to the 
implementation, a misconfiguration was included by the developers. The cut function allows to paste the image in raw format back to the message box. 
After the limitation was implemented for the pasted image counts and for the byte size of the clipboard, the attacker is still able to exploit the 
issue. Therefore an attacker uses the developer flaw that should fix the new zero-day vulnerability. The attacker copies the content via remote 
session of the clipboard via cache, then he uses the cut ability of skype with the context menu and repaste the input again. After that the images 
are getting transfered in raw format as text value of the skype code [image] by repasting them to the message box query, the vulnerability can be 
triggered again and the limiation of size and count is bypassed.
-------------------------------------------------------------
The successful attack scenario is not limited to manual exploitation only. Attackers can locally prepare the cache and clipboard of a computersystem 
to exploit the connected remote party computer system using skype.
-------------------------------------------------------------
The security risk of the skype vulnerability is estimated as high with a cvss (common vulnerability scoring system) count of 7.2. Exploitation of 
the buffer overflow software vulnerability requires no user interaction and only a low privilege skype user account. Successful exploitation of the 
buffer overflow vulnerability results in system and process compromise by an overwrite of the registers.
-----------------------------------------
Vulnerable Software Client(s):
[+] Microsoft Skype v7.3.6
[+] Microsoft Skype v7.3.5.103
[+] Microsoft Skype v7.2
--------------------------------------------
Vulnerable Function(s):
[+] clipboard (remote session)
---------------------------------------
Affected Library:
[+] MSFTEDIT.DLL

----------------------------------------------------
Proof of Concept (PoC):
=======================
The buffer overflow vulnerability can be exploited by local and remote attackers without user interaction and with low privileged skype user account.
For security demonstration or to reproduce the vulnerability follow the provided information and steps below to continue.
!
sleep 1.3
read -p "Enter"
bash GihadAlkmaty0199.sh
else

if [ $menuoption = "9" ]; then
echo "ok !"
bash GihadAlkmaty0199.sh
else

if [ $menuoption = "10" ]; then
echo "ok !"
bash GihadAlkmaty0199.sh
else

if [ $menuoption = "11" ]; then
echo "ok !"
bash GihadAlkmaty0199.sh
else

if [ $menuoption = "12" ]; then
echo "ok !"
bash GihadAlkmaty0199.sh
else

if [ $menuoption = "13" ]; then
echo "ok !"
bash GihadAlkmaty0199.sh
else

if [ $menuoption = "tool" ]; then
echo "ok !"
cat << !
sleep 1.44
clear
#################################################################################
# Twitter www.Twitter.com/GihadAlkmaty
# Github www.Github.com/JihadLkmaty218
# facebook www.facebook.com/GihadAlkmatySy
# Page in facebook www.facebook.com/GihadAlkmaty-hak5
#-------------------------------------------------------
# i, GihadAlkmaty From Libya > 17 
# ok What Is the Tool 
#
#
#
#
#
#
#
#
#
#
##################################################################################
# tool Gihad Alkmaty
!
sleep 1.33
read -p "Enter"
bash GihadAlkmaty0199.sh
else
if [ $menuoption = "14" ]; then
echo "ok !"
bash GihadAlkmaty0199.sh
else

if [ $menuoption = "15" ]; then
echo "ok !"
bash GihadAlkmaty0199.sh
else

if [ $menuoption = "16" ]; then
echo "ok !"
bash GihadAlkmaty0199.sh
else

if [ $menuoption = "update" ]; then
echo "ok !"
bash  update.sh
else

if [ $menuoption = "17" ]; then
exit
fi
fi
fi
fi
fi
fi
fi
fi
fi
fi
fi
fi
fi
fi
fi
fi
fi
fi
fi
